{"version":3,"file":"addwordtowordcloud.min.js","sources":["../src/addwordtowordcloud.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/notification', 'core/modal_factory', 'core/str'],\n    function ($, ajax, notification, ModalFactory, str) {\n        return {\n            init: function (refreshtime, aid, timestamphtml) {\n                $('#mod-wordcloud-new-word').keypress(function (e) {\n                    // filter enter key to auto commit the word\n                    if (e.keyCode === 13) {\n                        $('#mod-wordcloud-btn').click();\n                    }\n                });\n                $.mod_wordcloud_add_word = function () {\n                    var word = $('#mod-wordcloud-new-word').val();\n\n                    if (!word.trim()) {\n                        return;\n                    }\n\n                    ajax.call([{\n                        methodname: 'mod_wordcloud_add_word',\n                        args: {aid: aid, word: word},\n                        done: function (returnval) {\n                            if (!returnval.cloudhtml) {\n                                ModalFactory.create({\n                                    type: ModalFactory.types.CANCEL,\n                                    title: str.get_string('warning', 'mod_wordcloud'),\n                                    body: returnval.warnings[0].message,\n                                }).then(function (modal) {\n                                    modal.show();\n                                });\n                            } else {\n                                $('#mod-wordcloud-words-box').html(returnval.cloudhtml);\n                                $('#mod-wordcloud-new-word').val('');\n\n                                var wb = document.getElementById('mod-wordcloud-div');\n                                var divheight = wb.offsetHeight;\n                                var newwidth = 0;\n                                if (divheight < 300) {\n                                    newwidth = 60;\n                                } else if (divheight < 500) {\n                                    newwidth = 70;\n                                } else if (divheight < 700) {\n                                    newwidth = 80;\n                                } else {\n                                    newwidth = 100;\n                                }\n                                if (newwidth > parseInt(wb.style.width) && window.innerWidth > 900) {\n                                    wb.style.width = newwidth + \"%\";\n                                }\n                            }\n                        },\n                        fail: notification.exception\n                    }]);\n                };\n                setInterval(function(){\n                    ajax.call([{\n                        methodname: 'mod_wordcloud_get_words',\n                        args: {aid: aid, timestamphtml: timestamphtml},\n                        done: function (returnval) {\n                            if (returnval.cloudhtml) {\n                                $('#mod-wordcloud-words-box').html(returnval.cloudhtml);\n                                timestamphtml = returnval.timestamphtml;\n                                var wb = document.getElementById('mod-wordcloud-div');\n                                var divheight = wb.offsetHeight;\n                                var newwidth = 0;\n                                if (divheight < 400) {\n                                    newwidth = 60;\n                                } else if (divheight < 600) {\n                                    newwidth = 70;\n                                } else if (divheight < 800) {\n                                    newwidth = 80;\n                                } else {\n                                    newwidth = 100;\n                                }\n                                if (newwidth > parseInt(wb.style.width) && window.innerWidth > 900) {\n                                    wb.style.width = newwidth + \"%\";\n                                }\n                            }\n                        },\n                        fail: notification.exception\n                    }]);\n                },refreshtime*1000);\n            }\n        };\n    });"],"names":["define","$","ajax","notification","ModalFactory","str","init","refreshtime","aid","timestamphtml","keypress","e","keyCode","click","mod_wordcloud_add_word","word","val","trim","call","methodname","args","done","returnval","cloudhtml","html","wb","document","getElementById","divheight","offsetHeight","newwidth","parseInt","style","width","window","innerWidth","create","type","types","CANCEL","title","get_string","body","warnings","message","then","modal","show","fail","exception","setInterval"],"mappings":"AAAAA,0CAAO,CAAC,SAAU,YAAa,oBAAqB,qBAAsB,aACtE,SAAUC,EAAGC,KAAMC,aAAcC,aAAcC,WACpC,CACHC,KAAM,SAAUC,YAAaC,IAAKC,eAC9BR,EAAE,2BAA2BS,UAAS,SAAUC,GAE1B,KAAdA,EAAEC,SACFX,EAAE,sBAAsBY,WAGhCZ,EAAEa,uBAAyB,eACnBC,KAAOd,EAAE,2BAA2Be,MAEnCD,KAAKE,QAIVf,KAAKgB,KAAK,CAAC,CACPC,WAAY,yBACZC,KAAM,CAACZ,IAAKA,IAAKO,KAAMA,MACvBM,KAAM,SAAUC,cACPA,UAAUC,UAQR,CACHtB,EAAE,4BAA4BuB,KAAKF,UAAUC,WAC7CtB,EAAE,2BAA2Be,IAAI,QAE7BS,GAAKC,SAASC,eAAe,qBAC7BC,UAAYH,GAAGI,aACfC,SAAW,GAEXA,SADAF,UAAY,IACD,GACJA,UAAY,IACR,GACJA,UAAY,IACR,GAEA,KAEAG,SAASN,GAAGO,MAAMC,QAAUC,OAAOC,WAAa,MAC3DV,GAAGO,MAAMC,MAAQH,SAAW,UAxBhC1B,aAAagC,OAAO,CAChBC,KAAMjC,aAAakC,MAAMC,OACzBC,MAAOnC,IAAIoC,WAAW,UAAW,iBACjCC,KAAMpB,UAAUqB,SAAS,GAAGC,UAC7BC,MAAK,SAAUC,OACdA,MAAMC,WAuBlBC,KAAM7C,aAAa8C,cAG3BC,aAAY,WACRhD,KAAKgB,KAAK,CAAC,CACPC,WAAY,0BACZC,KAAM,CAACZ,IAAKA,IAAKC,cAAeA,eAChCY,KAAM,SAAUC,cACRA,UAAUC,UAAW,CACrBtB,EAAE,4BAA4BuB,KAAKF,UAAUC,WAC7Cd,cAAgBa,UAAUb,kBACtBgB,GAAKC,SAASC,eAAe,qBAC7BC,UAAYH,GAAGI,aACfC,SAAW,GAEXA,SADAF,UAAY,IACD,GACJA,UAAY,IACR,GACJA,UAAY,IACR,GAEA,KAEAG,SAASN,GAAGO,MAAMC,QAAUC,OAAOC,WAAa,MAC3DV,GAAGO,MAAMC,MAAQH,SAAW,OAIxCkB,KAAM7C,aAAa8C,eAEb,IAAZ1C"}